import{j as m,a as t,r as s,V as v,_ as C,F as N,u as x}from"./index-22934f6f.js";import{a as P}from"./axios-707ed124.js";function B({progressStatus:e}){return m("div",{className:"progress-bar__box",children:[t("div",{className:"progress-bar__loading",style:{width:`${e}%`}}),t("div",{className:"progress-bar__grid-half"})]})}function y(e){const[a,o]=s.useState(0),n=s.useContext(v);let l=null;const c=e.sentence.length,g=c<8?c*190:c*180;return t("button",{className:"play-btn",onClick:()=>{o(d=>d===0?(n==null||n.readTextWithVoice(e.sentence),l=setTimeout(()=>{o(0)},g),1):(clearTimeout(l),n==null||n.stopReadText(),0))},children:t("i",{className:`${a===0?"fa fa-play":"fa fa-pause"}`})})}function h(e){const a=s.useRef(null),o=n=>{var l;(l=a.current)==null||l.classList.add("word__container--fade-out"),setTimeout(()=>n(),300)};return m("div",{className:"flex-column--centered word__container",ref:a,children:[t("img",{className:"flex-element word__img",src:e.imageURL,alt:e.wordName}),t("h3",{children:e.wordName}),m("h4",{children:["[ ",e.translation," ]"]}),m("h5",{className:"u-center-text",children:["Ex : ",e.example," "]}),t(y,{sentence:e.wordName}),m("div",{className:"arrow-ctn",children:[e.previousWord!==void 0&&t("i",{className:"fas fa-chevron-circle-left",onClick:()=>o(e.previousWord)}),e.nextWord!==void 0&&t("i",{className:"fas fa-chevron-circle-right arrow-right",onClick:()=>o(e.nextWord)})]})]})}function R(e){const[a,o]=s.useState(0),n=e.unkwonWords.length,[l,c]=s.useState(0);s.useEffect(()=>{e.setProgressBar(l)},[l]);const g=r=>{c(i=>i+50/n),o(r)},u=r=>{c(i=>i-50/n),o(r)},d=()=>{c(r=>r+50/n),e.toExecises()},f=s.useMemo(()=>e.unkwonWords.map((r,i)=>i===0?s.createElement(h,{...r,key:i,nextWord:()=>g(i+1)}):i===n-1?s.createElement(h,{...r,key:i,previousWord:()=>u(i-1),nextWord:d}):s.createElement(h,{...r,key:i,previousWord:()=>u(i-1),nextWord:()=>g(i+1)})),[e.unkwonWords]);return t("div",{children:f[a]})}function H(e){return s.useContext(v),t("div",{})}const M=s.lazy(()=>C(()=>import("./StartView-af8e586c.js"),["assets/StartView-af8e586c.js","assets/index-22934f6f.js","assets/index-580a3a2b.css"]));function j(e){const[a,o]=s.useState(0),[n,l]=s.useState([]),[c,g]=s.useState(),u=sessionStorage.getItem("lessonType"),d=r=>{e.triggerTransition(),setTimeout(()=>o(r),450)},f=r=>{const i=[];return P.post("http://localhost:5000/lessons/getWords",{moduleId:r}).then(_=>(_.data.forEach(b=>{const{id:k,word:I,translation:w,example:S,moduleId:W}=b,T=new Uint8Array(b.image.data),E=new Blob([T],{type:"application/octet-stream"}),L=URL.createObjectURL(E);i.push({id:k,wordName:I,translation:w,example:S,moduleId:W,imageURL:L})}),i))};return s.useEffect(()=>{(u==="new_words"||u==="pronunciation"||u==="test")&&f(e.moduleId).then(r=>{r.sort((i,_)=>.5-Math.random()),l(r)})},[e.moduleId]),s.useEffect(()=>{if(u==="new_words"){g(t(R,{toExecises:()=>d(2),unkwonWords:n,setProgressBar:e.setProgressBar}));return}if(u==="pronunciation"){g(t(H,{toExecises:()=>d(2),unkwonWords:n}));return}},[n]),m(N,{children:[a===0&&t(M,{title:e.lessonTitle,startClickHandler:()=>d(1)}),a===1&&c]})}function U(e){const[a,o]=s.useState(!1),n=x(),l=s.useCallback(()=>{sessionStorage.setItem("lessonId",""),sessionStorage.setItem("moduleId",""),sessionStorage.setItem("lessonTitle",""),o(!0),setTimeout(()=>n(-1),410)},[]),c=s.useCallback(()=>{o(!0),setTimeout(()=>e.closeBk(),350)},[]);return t("div",{className:`exit_message__blackdrop ${a&&"exit_message__blackdrop--close"}`,children:m("div",{className:"exit_message__box flex-column--centered",children:[t("div",{className:"btn_exit_ctn",children:t("div",{className:"btn_exit",onClick:c,children:" × "})}),t("h3",{children:" Sigur dorești să închizi lecția ? "}),m("div",{className:"flex-row--centered",children:[t("div",{className:"btn btn--white lesson-btn",onClick:l,children:" Da "}),t("div",{className:"btn btn--blue lesson-btn",onClick:c,children:" Nu "})]})]})})}function V(){const[e,a]=s.useState(!1);return m(N,{children:[e&&t(U,{closeBk:()=>a(!1)}),t("div",{className:"lesson__exit",children:t("button",{className:"lesson__exit__btn",onClick:()=>{a(!0)},children:"×"})})]})}function O(e,a){const o=s.useRef(null);return s.useImperativeHandle(a,()=>({trigger:()=>{o.current.classList.add("lesson-transition--animated")}}),[]),t("div",{className:"lesson-transition",onAnimationEnd:()=>{o.current.classList.remove("lesson-transition--animated")},ref:o})}const p=s.forwardRef(O);function D(){const[e,a]=s.useState({lessonId:-1,moduleId:-1,lessonTitle:""}),[o,n]=s.useState(0),l=x(),c=s.useRef({trigger:()=>{}});s.useEffect(()=>{const d=sessionStorage.getItem("lessonId"),f=sessionStorage.getItem("moduleId"),r=sessionStorage.getItem("lessonTitle");d&&f&&r?a({lessonId:+d,moduleId:+f,lessonTitle:r}):l("/Licenta/PageNotFound")},[]);const g=s.useCallback(d=>{d>=0&&d<=100&&n(d)},[]),u=s.useCallback(()=>{c.current.trigger()},[]);return m("section",{className:"lesson-section",children:[m("div",{className:"lesson-ctn",children:[e.lessonId>=0&&t(j,{...e,setProgressBar:g,triggerTransition:u}),t(p,{ref:c})]}),t("div",{className:"lesson__progress-bar",children:t(B,{progressStatus:o})}),t(V,{})]})}export{D as default};
