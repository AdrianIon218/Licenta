var x=Object.defineProperty;var C=(t,s,e)=>s in t?x(t,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[s]=e;var g=(t,s,e)=>(C(t,typeof s!="symbol"?s+"":s,e),e);import{r as u,u as I,j as p,a as n}from"./index-464a880c.js";import{I as d}from"./commonInterfaces-83a6a30d.js";import{C as v,L as h,a as L}from"./CoursePlan-e1a0d052.js";import{a as R}from"./axios-707ed124.js";function E({children:t,status:s,lessonId:e,moduleId:S,type:c}){const{courseLvl:a}=u.useContext(v),_=I(),r=l=>{l.stopPropagation(),sessionStorage.setItem("lessonId",e.toString()),sessionStorage.setItem("moduleId",S.toString()),sessionStorage.setItem("lessonTitle",t),sessionStorage.setItem("lessonType",c),_("/Licenta/lesson")};return p("div",{className:"course-lesson",children:[n("button",{className:`course-lesson-btn course-lesson-btn--${h[a]}`,onClick:r,children:t}),p("div",{className:`course-status ${a<h.B1?"course-status--A":a>h.B2?"course-status--C":"course-status--B"}`,children:[n("i",{className:`fa fa-star ${s!==d.NO_PROGRESS&&"course-status--checked"}`}),n("i",{className:`fa fa-star ${s===d.STAR_3&&"course-status--checked"}`}),n("i",{className:`fa fa-star ${s>d.STAR_1&&"course-status--checked"}`})]})]})}function M({title:t,activeModule:s,index:e,closeOtherModules:S,lessons:c}){const[a,_]=u.useState(!1),r=h[u.useContext(v).courseLvl],l=()=>{_(o=>(o===!1&&S(),!o))};u.useEffect(()=>{s!==e&&_(!1)},[s]);const m=u.useMemo(()=>c.map((o,i)=>n(E,{status:o.status??d.NO_PROGRESS,lessonId:o.id,moduleId:o.moduleId,type:o.type,children:o.title},i)),[c]);return p("div",{className:"course__module flex-element",tabIndex:e,children:[p("div",{className:"course__module__title u-center-text",onClick:l,children:[t.str,n("span",{className:`course__module__title__arrow course__module__title__arrow--${r}`,children:n("i",{className:` ${a?"fas fa-chevron-up":"fas fa-chevron-down"} `})})]}),n("div",{className:`course__module__ctn ${a&&"course__module__ctn--open"}`,children:n("div",{className:`flex-column--start course__module__ctn__list course__module__ctn__list--${r} ${a&&"course__module__ctn__list--open"}`,children:m})})]})}class ${constructor(s,e){g(this,"_str","Not available");g(this,"setStr",s=>{const e=s.length;e>0&&e<=this.dimension?this._str=s:e===0?this._str="Not available":this._str=s.substring(0,this.dimension)});this.dimension=e,this.setStr(s)}set str(s){this.setStr(s)}get str(){return this._str}}function P({level:t}){const[s,e]=u.useState(-1),S=u.useContext(v),[c,a]=u.useState({modules:[]});u.useEffect(()=>{S.setCourseLvl(t);const r=localStorage.getItem("userAccount");R.get("http://localhost:5000/course_modules",{params:{level:h[t],email:r}}).then(l=>{const{lessons:m,modules:o}=l.data;let i=o.map(f=>({title:f.title,lessons:m.filter(N=>N.moduleId===f.id)}));if(r){const{finishedLessons:f}=l.data;a({modules:i,finishedLessons:f})}else a({modules:i})})},[]);const _=u.useMemo(()=>c.modules.map((r,l)=>{const m=c.finishedLessons?r.lessons.map(o=>{const i=c.finishedLessons.find(f=>f.lessonId===o.id);return{...o,status:i?i.progressStatus==="good"?d.STAR_1:i.progressStatus==="very good"?d.STAR_2:d.STAR_3:d.NO_PROGRESS}}):r.lessons;return m.length>0?n(M,{title:new $(r.title,L),index:l,activeModule:s,lessons:m,closeOtherModules:()=>e(l)},l):void 0}),[c,s]);return n("div",{className:`course-plan course-plan--${h[t]}`,children:n("div",{className:"flex-column--centered",children:_})})}export{P as default};
