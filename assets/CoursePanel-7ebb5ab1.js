var x=Object.defineProperty;var C=(t,s,e)=>s in t?x(t,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[s]=e;var g=(t,s,e)=>(C(t,typeof s!="symbol"?s+"":s,e),e);import{r as c,u as I,j as p,a as o,e as L}from"./index-e6895c97.js";import{I as d}from"./commonInterfaces-83a6a30d.js";import{C as v,L as h,a as R}from"./CoursePlan-bcaf35ce.js";function E({children:t,status:s,lessonId:e,moduleId:S,type:a}){const{courseLvl:l}=c.useContext(v),m=I(),r=u=>{u.stopPropagation(),sessionStorage.setItem("lessonId",e.toString()),sessionStorage.setItem("moduleId",S.toString()),sessionStorage.setItem("lessonTitle",t),sessionStorage.setItem("lessonType",a),m("/lesson")};return p("div",{className:"course-lesson",children:[o("button",{className:`course-lesson-btn course-lesson-btn--${h[l]}`,onClick:r,children:t}),p("div",{className:`course-status ${l<h.B1?"course-status--A":l>h.B2?"course-status--C":"course-status--B"}`,children:[o("i",{className:`fa fa-star ${s!==d.NO_PROGRESS&&"course-status--checked"}`}),o("i",{className:`fa fa-star ${s===d.STAR_3&&"course-status--checked"}`}),o("i",{className:`fa fa-star ${s>d.STAR_1&&"course-status--checked"}`})]}),a==="pronunciation"&&o("div",{className:"course-pronunciation",children:o("i",{className:"fa fa-microphone"})})]})}function M({title:t,activeModule:s,index:e,closeOtherModules:S,lessons:a}){const[l,m]=c.useState(!1),r=h[c.useContext(v).courseLvl],u=()=>{m(n=>(n===!1&&S(),!n))};c.useEffect(()=>{s!==e&&m(!1)},[s]);const _=c.useMemo(()=>a.map((n,i)=>o(E,{status:n.status??d.NO_PROGRESS,lessonId:n.id,moduleId:n.moduleId,type:n.type,children:n.title},i)),[a]);return p("div",{className:"course__module flex-element",tabIndex:e,children:[p("div",{className:"course__module__title u-center-text",onClick:u,children:[t.str,o("span",{className:`course__module__title__arrow course__module__title__arrow--${r}`,children:o("i",{className:` ${l?"fas fa-chevron-up":"fas fa-chevron-down"} `})})]}),o("div",{className:`course__module__ctn ${l&&"course__module__ctn--open"}`,children:o("div",{className:`flex-column--start course__module__ctn__list course__module__ctn__list--${r} ${l&&"course__module__ctn__list--open"}`,children:_})})]})}class ${constructor(s,e){g(this,"_str","Not available");g(this,"setStr",s=>{const e=s.length;e>0&&e<=this.dimension?this._str=s:e===0?this._str="Not available":this._str=s.substring(0,this.dimension)});this.dimension=e,this.setStr(s)}set str(s){this.setStr(s)}get str(){return this._str}}function k({level:t}){const[s,e]=c.useState(-1),S=c.useContext(v),[a,l]=c.useState({modules:[]});c.useEffect(()=>{S.setCourseLvl(t);const r=localStorage.getItem("userAccount");L.get("http://localhost:5000/course_modules",{params:{level:h[t],email:r}}).then(u=>{const{lessons:_,modules:n}=u.data;let i=n.map(f=>({title:f.title,lessons:_.filter(N=>N.moduleId===f.id)}));if(r){const{finishedLessons:f}=u.data;l({modules:i,finishedLessons:f})}else l({modules:i})})},[]);const m=c.useMemo(()=>a.modules.map((r,u)=>{const _=a.finishedLessons?r.lessons.map(n=>{const i=a.finishedLessons.find(f=>f.lessonId===n.id);return{...n,status:i?i.progressStatus==="good"?d.STAR_1:i.progressStatus==="very good"?d.STAR_2:d.STAR_3:d.NO_PROGRESS}}):r.lessons;return _.length>0?o(M,{title:new $(r.title,R),index:u,activeModule:s,lessons:_,closeOtherModules:()=>e(u)},u):void 0}),[a,s]);return o("div",{className:`course-plan course-plan--${h[t]}`,children:o("div",{className:"flex-column--centered",children:m})})}export{k as default};
