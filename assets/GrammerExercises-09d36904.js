import{r as u,j as l,F as C,a as t,e as N,R as S}from"./index-927f409d.js";import{N as v,a as w}from"./Notfication-431797d0.js";import{I as x}from"./commonInterfaces-83a6a30d.js";function k(e){const[r,o]=u.useState(!1),[c,m]=u.useState(!1),[h,f]=u.useState(!1),a=d=>{d.currentTarget.value==="true"===e.structure.state?(f(!0),o(!0),m(!0)):(f(!1),o(!0),m(!0))},n=()=>{h?e.correctAnswear():e.wrongAnswear()};return l(C,{children:[r&&t(v,{message:`Propoziția este ${e.structure.state?"correctă ":"incorectă "}!`,type:h?w.SUCCESS:w.ERROR,deleteNotification:()=>o(!1)}),l("div",{className:"flex-column--centered exercise",children:[t("h3",{children:"Este corectă propoziția din punct de vedere gramatical ?"}),t("h4",{children:e.structure.sentence}),l("div",{children:[t("button",{value:"flase",disabled:c,onClick:a,className:"false-btn",children:"Falsch"}),t("button",{value:"true",disabled:c,onClick:a,className:"true-btn",children:"Richtig"})]}),c&&t("div",{className:"flex-column--centered",children:e.structure.correct_sentence&&t("h4",{className:"correct_sentence",children:`Varianta corectă : ${e.structure.correct_sentence}`})}),c&&t("button",{className:"submitBtn u-center-text",onClick:n,children:"Continuă"})]})]})}function E(e){const r=u.useRef(null),[o,c]=u.useState({isShown:!1,isCorrect:!1}),m=a=>{r.current.innerText=a.currentTarget.value},h=()=>{if(o.isShown){o.isCorrect?e.correctAnswear():e.wrongAnswear();return}const a=r.current.innerText;a!=""&&(a===e.structure.correctAnswear?c({isShown:!0,isCorrect:!0}):c({isShown:!0,isCorrect:!1}))},f=e.structure.choices.map((a,n)=>t("button",{onClick:m,className:o.isShown?a===e.structure.correctAnswear?"backgd-green":"backgd-red":"",value:a,disabled:o.isShown,children:a},n));return l("div",{className:"flex-column--centered exercise",children:[t("h3",{children:"Completează propoziția"}),l("h4",{children:[e.structure.sentence_part_1," ",t("span",{className:`block-transparent ${o.isShown?o.isCorrect?"backgd-green":"backgd-red":""}`,ref:r})," ",e.structure.sentence_part_2]}),t("div",{className:"box-btns",children:f}),l("button",{className:"submitBtn u-center-text",onClick:h,children:[o.isShown?"Continuă":"Verifică"," ",t("i",{className:"fas fa-angle-double-right"})]})]})}function A(e){const[r,o]=u.useState([]),[c,m]=u.useState({isShown:!1,isCorrect:!1}),h=e.structure.choices.map(s=>s[0]).map((s,i)=>l("li",{children:[t("div",{className:"u-center-text",children:s}),t("div",{className:`u-center-text ${c.isShown?r[i]===e.structure.choices[i][1]?"backgd-green":"backgd-red":""}`,children:r[i]??""})]},i)),f=s=>{const{value:i}=s.currentTarget;o(g=>g.concat([i]))},n=u.useMemo(()=>e.structure.choices.map(s=>s[1]).sort((s,i)=>.5-Math.random()),[]).map((s,i)=>t("button",{onClick:f,value:s,disabled:r.length===h.length||r.includes(s),children:s},i)),d=()=>{if(r.length===e.structure.choices.length){const s=e.structure.choices.every((i,g)=>i[1]===r[g]);m({isShown:!0,isCorrect:s})}},b=s=>{if(s.currentTarget.disabled=!0,c.isCorrect){e.correctAnswear();return}e.wrongAnswear()};return l("div",{className:"flex-column--centered exercise",children:[t("h3",{children:"Completează perechiile"}),t("ul",{className:"choices-match-box",children:h}),t("div",{className:"box-btns choices-box",children:n}),l("button",{className:"submitBtn u-center-text",onClick:()=>{o([])},hidden:c.isShown,children:[t("i",{className:"fa fa-refresh"})," Reset"]}),l("button",{className:"submitBtn u-center-text",onClick:d,hidden:c.isShown,children:["Verifică ",t("i",{className:"fas fa-angle-double-right"})]}),c.isShown&&!c.isCorrect&&t("ul",{className:"choices-box correct-choices",children:e.structure.choices.map((s,i)=>t("li",{children:s.join(" ")},i))}),c.isShown&&l("button",{className:"submitBtn u-center-text",onClick:b,children:["Continuă ",t("i",{className:"fas fa-angle-double-right"})]})]})}function R(e){const[r,o]=u.useState([]),[c,m]=u.useState({isShown:!1,isCorrect:!1}),h=s=>{const{value:i}=s.currentTarget;o(g=>[...g,i])},f=e.structure.words.map((s,i)=>t("span",{className:`block-transparent u-center-text ${c.isShown?s===r[i]?"backgd-green":"backgd-red":""}`,children:r[i]},i)),n=u.useMemo(()=>[...e.structure.words].sort((s,i)=>.5-Math.random()),[]).map((s,i)=>t("button",{onClick:h,value:s,disabled:r.includes(s),children:s},i)),d=()=>{if(n.length===e.structure.words.length){const s=e.structure.words.every((i,g)=>i===r[g]);m({isShown:!0,isCorrect:s})}},b=s=>{if(s.currentTarget.disabled=!0,c.isCorrect){e.correctAnswear();return}e.wrongAnswear()};return l("div",{className:"flex-column--centered exercise",children:[t("h3",{className:"u-center-text",children:"Ordonează cuvintele astfel încât propoziția să fie corectă !"}),t("p",{className:"flex-row--centered sentence-builder",children:f}),t("div",{className:"box-btns choices-box",children:n}),l("button",{className:"submitBtn u-center-text",onClick:()=>{o([])},hidden:c.isShown,children:[t("i",{className:"fa fa-refresh"})," Reset"]}),l("button",{className:"submitBtn u-center-text",onClick:d,hidden:c.isShown,children:["Verifică ",t("i",{className:"fas fa-angle-double-right"})]}),c.isShown&&!c.isCorrect&&t("div",{className:"choices-box correct-choices flex-column--centered",children:e.structure.words.join(" ")}),c.isShown&&l("button",{className:"submitBtn u-center-text",onClick:b,children:["Continuă ",t("i",{className:"fas fa-angle-double-right"})]})]})}function I(e){const[r,o]=u.useState({score:0,currentExIndex:0,progressBar:50}),[c,m]=u.useState([]);u.useEffect(()=>{e.addProgress(r.progressBar)},[r.progressBar]);const h=a=>{o(n=>({score:n.score+1,currentExIndex:n.currentExIndex+1,progressBar:n.progressBar+a}))},f=a=>{o(n=>({score:n.score-1,currentExIndex:n.currentExIndex+1,progressBar:n.progressBar+a}))};return u.useEffect(()=>{N.post("http://localhost:5000/lessons/grammer/getExercises",{lessonId:e.lessonId}).then(a=>{const n=a.data;n.sort((d,b)=>.5-Math.random()),m(n.map((d,b)=>{const s={structure:d.structure,correctAnswear:()=>h(50/n.length),wrongAnswear:()=>f(50/n.length)};return l(S.Fragment,{children:[d.type==="true_false"&&t(k,{...s}),d.type==="complete_sentence"&&t(E,{...s}),d.type==="match_choices"&&t(A,{...s}),d.type==="order_words"&&t(R,{...s})]},b)}))})},[e.lessonId]),u.useEffect(()=>{const a=c.length;if(r.currentExIndex>0&&r.currentExIndex===a)if(e.currentScore&&e.previousExercisesNum){const n=r.score+e.currentScore,d=a+e.previousExercisesNum,b=n>d/2?x.STAR_3:n>d/3?x.STAR_2:x.STAR_1;e.toFinish(b)}else{const n=r.score>a/2?x.STAR_3:r.score>a/3?x.STAR_2:x.STAR_1;e.toFinish(n)}},[r]),t(S.Fragment,{children:c[r.currentExIndex]})}export{I as default};
