var C=Object.defineProperty;var x=(s,e,t)=>e in s?C(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var R=(s,e,t)=>(x(s,typeof e!="symbol"?e+"":e,t),t);import{r as n,j as p,a as r}from"./index-51d57f2d.js";import{C as v,L as f,a as A}from"./CoursePlan-84527c71.js";import{a as N}from"./axios-707ed124.js";var u=(s=>(s[s.NO_PROGRESS=0]="NO_PROGRESS",s[s.STAR_1=1]="STAR_1",s[s.STAR_2=2]="STAR_2",s[s.STAR_3=3]="STAR_3",s))(u||{});function E({children:s,status:e}){const{courseLvl:t}=n.useContext(v),c=_=>{_.stopPropagation()};return p("div",{className:"course-lesson",children:[r("button",{className:`course-lesson-btn course-lesson-btn--${f[t]}`,onClick:c,children:s}),p("div",{className:`course-status ${t<f.B1?"course-status--A":t>f.B2?"course-status--C":"course-status--B"}`,children:[r("i",{className:`fa fa-star ${e!==u.NO_PROGRESS&&"course-status--checked"}`}),r("i",{className:`fa fa-star ${e===u.STAR_3&&"course-status--checked"}`}),r("i",{className:`fa fa-star ${e>u.STAR_1&&"course-status--checked"}`})]})]})}function L({title:s,activeModule:e,index:t,closeOtherModules:c,lessons:_}){const[h,a]=n.useState(!1),l=f[n.useContext(v).courseLvl],m=()=>{a(o=>(o===!1&&c(),!o))};n.useEffect(()=>{e!==t&&a(!1)},[e]);const i=n.useMemo(()=>_.map((o,d)=>r(E,{status:o.status??u.NO_PROGRESS,children:o.title},d)),[_]);return p("div",{className:"course__module flex-element",tabIndex:t,children:[p("div",{className:"course__module__title u-center-text",onClick:m,children:[s.str,r("span",{className:`course__module__title__arrow course__module__title__arrow--${l}`,children:r("i",{className:` ${h?"fas fa-chevron-up":"fas fa-chevron-down"} `})})]}),r("div",{className:`course__module__ctn ${h&&"course__module__ctn--open"}`,children:r("div",{className:`flex-column--start course__module__ctn__list course__module__ctn__list--${l} ${h&&"course__module__ctn__list--open"}`,children:i})})]})}class T{constructor(e,t){R(this,"_str","Not available");R(this,"setStr",e=>{const t=e.length;t>0&&t<=this.dimension?this._str=e:t===0?this._str="Not available":this._str=e.substring(0,this.dimension)});this.dimension=t,this.setStr(e)}set str(e){this.setStr(e)}get str(){return this._str}}function P({level:s}){const[e,t]=n.useState(-1);n.useContext(v).setCourseLvl(s);const[c,_]=n.useState({modules:[]});n.useEffect(()=>{const a=sessionStorage.getItem("userAccount");a?N.get("http://localhost:5000/course_modules",{params:{level:f[s],email:a}}).then(l=>{const{lessons:m,modules:i}=l.data;let o=i.map(S=>({title:S.title,lessons:m.filter(g=>g.moduleId===S.id)}));const{finishedLessons:d}=l.data;_({modules:o,finishedLessons:d})}):N.get("http://localhost:5000/course_modules",{params:{level:f[s]}}).then(l=>{const{lessons:m,modules:i}=l.data,o=i.map(d=>({title:d.title,lessons:m.filter(S=>S.moduleId===d.id)}));_({modules:o})})},[]);const h=n.useMemo(()=>c.modules.map((a,l)=>{const m=c.finishedLessons?a.lessons.map(i=>{const o=c.finishedLessons.find(d=>d.lessonId===i.id);return{...i,status:o?o.progressStatus==="good"?u.STAR_1:o.progressStatus==="very good"?u.STAR_2:u.STAR_3:u.NO_PROGRESS}}):a.lessons;return r(L,{title:new T(a.title,A),index:l,activeModule:e,lessons:m,closeOtherModules:()=>t(l)},l)}),[c,e]);return r("div",{className:`course-plan course-plan--${f[s]}`,children:r("div",{className:"flex-column--centered",children:h})})}export{P as default};
