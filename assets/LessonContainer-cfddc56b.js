import{j as l,a as s,r as t,V as A,F as v,u as L,e as P,_ as I}from"./index-927f409d.js";import{I as _}from"./commonInterfaces-83a6a30d.js";import{N as y,a as M}from"./Notfication-431797d0.js";function X({progressStatus:e}){return l("div",{className:"progress-bar__box",children:[s("div",{className:"progress-bar__loading",style:{width:`${e}%`}}),s("div",{className:"progress-bar__grid-half"})]})}function S(e){const[r,o]=t.useState(0),n=t.useContext(A),i=e.sentence.length,u=i<8?i*190:i>20?i*120:i*170;return s("button",{className:"play-btn",onClick:()=>{o(a=>a===0?(n==null||n.readTextWithVoice(e.sentence),setTimeout(()=>{o(0)},u),1):a)},children:s("i",{className:`${r===0?"fa fa-play":"fa fa-pause"}`})})}function W(e){const r=t.useRef(null),[o,n]=t.useState(!1),i=u=>{var d;o||((d=r.current)==null||d.classList.add("word__container--fade-out"),setTimeout(()=>u(),300),n(!0))};return l("div",{className:"flex-column--centered word__container",ref:r,children:[s("img",{className:"flex-element word__img",src:e.imageURL,alt:e.wordName}),s("h3",{className:"u-center-text",children:e.wordName}),l("h4",{className:"u-center-text",children:["[ ",e.translation," ]"]}),l("h5",{className:"u-center-text",children:["Ex : ",e.example," "]}),s(S,{sentence:e.wordName}),l("div",{className:"arrow-ctn",children:[e.previousWord!==void 0&&s("i",{className:"fas fa-chevron-circle-left",onClick:()=>i(e.previousWord)}),e.nextWord!==void 0&&s("i",{className:"fas fa-chevron-circle-right arrow-right",onClick:()=>i(e.nextWord)})]})]})}function z(e){const[r,o]=t.useState(0),n=e.unkwonWords.length,[i,u]=t.useState(0);t.useEffect(()=>{e.setProgressBar(i)},[i]);const d=h=>{u(g=>g+50/n),o(h)},a=h=>{u(g=>g-50/n),o(h)},c=()=>{u(h=>h+50/n),e.toExecises()},m=t.useMemo(()=>e.unkwonWords.map((h,g)=>g===0?t.createElement(W,{...h,key:g,nextWord:()=>d(g+1)}):g===n-1?t.createElement(W,{...h,key:g,previousWord:()=>a(g-1),nextWord:c}):t.createElement(W,{...h,key:g,previousWord:()=>a(g-1),nextWord:()=>d(g+1)})),[e.unkwonWords]);return s("div",{children:m[r]})}const G=/[!"#$%&'()*+,-./:;<=>?@[\]^_`{|}~]/g;function b(e){let r=e.replace(G,"");return r=r.replace(/\s+/g," ").trim(),r}function B(e){return e.replace(/[ä]/g,"a").replace(/[ü]/g,"u").replace(/[ö]/g,"o")}function q(e){const r=t.useContext(A),[o,n]=t.useState(!1),i=e.textToLookFor.length<10?3:e.textToLookFor.length<20?4:7,u=B(b(e.textToLookFor.toLowerCase()));return s("button",{className:`play-btn btn-record ${o===!0?"btn-recording":""}`,onClick:()=>{if(!o)try{e.clickActions(),n(!0),r.startRecord(i).then(a=>{a=B(b(a.toLowerCase())),a===u?e.correctAnswear():e.wrongAnswear(),n(!1)})}catch{n(!1)}},children:s("i",{className:"fa fa-microphone"})})}function H(e){const[r,o]=t.useState(0),n=t.useCallback(()=>{e.correctAnswear()},[]),i=()=>{o(d=>d+1),e.wrongAnswear()},u=()=>{e.skip()};return l(v,{children:[r>=2&&s("button",{className:"btn-skip",onClick:u,children:"Skip"}),l("div",{className:"flex-column--centered word__container",children:[s("img",{className:"flex-element word__img",src:e.imageURL,alt:e.wordName}),s(S,{sentence:e.wordName}),s("h3",{className:"u-center-text",children:e.wordName}),l("h4",{className:"u-center-text",children:["[ ",e.translation," ]"]}),s(q,{textToLookFor:e.wordName,correctAnswear:n,wrongAnswear:i,clickActions:()=>e.stopNotification()})]})]})}function K(e){const r=(g,f)=>{switch(f.type){case 0:return{progressBarStatus:g.progressBarStatus+f.ratioProgress,score:g.score+1,currentWordIndex:g.currentWordIndex+1};case 1:return{...g,score:g.score-1};case 2:return{progressBarStatus:g.progressBarStatus+f.ratioProgress,score:g.score-1,currentWordIndex:g.currentWordIndex+1};default:return g}},[o,n]=t.useReducer(r,{progressBarStatus:0,score:0,currentWordIndex:0}),i=50/e.unkwonWords.length,[u,d]=t.useState(!1),a=()=>{e.setProgressBar(o.progressBarStatus+i),n({type:0,ratioProgress:i}),d(!1)},c=()=>{n({type:1,ratioProgress:0}),d(!0)},m=()=>{e.setProgressBar(o.progressBarStatus+i),n({type:2,ratioProgress:i}),d(!1)},h=e.unkwonWords.map((g,f)=>t.createElement(H,{...g,key:f,correctAnswear:a,wrongAnswear:c,skip:m,stopNotification:()=>d(!1)}));return l(v,{children:[u&&s(y,{message:"Răspuns greșit !",type:M.ERROR,deleteNotification:()=>d(!1)}),o.currentWordIndex<e.unkwonWords.length&&h[o.currentWordIndex],o.currentWordIndex===e.unkwonWords.length&&e.toExecises(o.score)]})}function Q(e){const[r,o]=t.useState(0),n=t.useRef(null),i=b(e.wordName.toLowerCase()),u=c=>{c.preventDefault(),b(n.current.value.toLowerCase())===i?e.correctAnswear():(n.current.value="",o(h=>h+1),e.wrongAnswear())},d=c=>{n.current.value.length<i.length&&(n.current.value+=c,n.current.focus())},a=t.useMemo(()=>["ä","ö","ü","ß"].map((c,m)=>s("button",{type:"button",onClick:()=>d(c),children:c},m)),[]);return l(v,{children:[l("div",{className:"info",children:[s("i",{className:"fa fa-lightbulb-o"}),s("span",{children:l("ul",{children:[s("li",{children:"Nu este nevoie să folosești majuscule ."}),s("li",{children:"Nu folosi semne de punctuație ."})]})})]}),r>=2&&s("button",{className:"btn-skip",onClick:e.skipExercise,children:"Skip"}),l("div",{className:"flex-column--centered word__container",children:[s("img",{className:"flex-element word__img",src:e.imageURL,alt:e.wordName}),s("h4",{className:"u-center-text",children:e.translation}),s(S,{sentence:e.example}),l("form",{onSubmit:u,className:"flex-column--centered write_word__form",children:[s("input",{type:"text",className:"flex-element u-center-text",maxLength:i.length,minLength:2,ref:n,autoFocus:!0}),s("div",{className:"flex-element u-center-text umlouts-ctn ",children:a}),l("button",{className:"submitBtn u-center-text",children:["Verfică ",s("i",{className:"fas fa-angle-double-right"})]})]})]})]})}function Y(e){const[r,o]=t.useState(""),n=t.useMemo(()=>{let a=e.wordNames.filter(c=>c!==e.wordName).sort((c,m)=>.5-Math.random()).slice(0,3).concat(e.wordName);return a=a.sort((c,m)=>.5-Math.random()),a},[e.wordNames]),i=a=>{o(a.target.value)},u=t.useMemo(()=>n.map((a,c)=>{const m=`choice-${c}`;return l("div",{className:"choice-ctn",children:[s("label",{htmlFor:m,className:r===a?"choice--checked":"",children:a}),s("input",{type:"checkbox",id:m,name:"choice",value:a,hidden:!0,onChange:i})]},c)}),[n,r]),d=a=>{a.preventDefault(),r===e.wordName?e.correctAnswear():r!==""&&e.wrongAnswear()};return l("div",{className:"flex-column--centered multiple-choice-ex",children:[s("img",{className:"flex-element word__img",src:e.imageURL,alt:e.wordName}),s("h4",{className:"u-center-text",children:e.translation}),l("form",{className:"flex-column--centered",children:[s("div",{className:"multiple-choices-ctn",children:u}),l("button",{className:"submitBtn u-center-text",onClick:d,children:["Verfică ",s("i",{className:"fas fa-angle-double-right"})]})]})]})}function Z(e){const[r,o]=t.useState(""),n=t.useMemo(()=>{let a=e.wordsTranslation.filter(c=>c!==e.translation).sort((c,m)=>.5-Math.random()).slice(0,3).concat(e.translation);return a=a.sort((c,m)=>.5-Math.random()),a},[e.wordsTranslation]),i=a=>{o(a.target.value)},u=t.useMemo(()=>n.map((a,c)=>{const m=`choice-${c}`;return l("div",{className:"choice-ctn",children:[s("label",{htmlFor:m,className:r===a?"choice--checked":"",children:a}),s("input",{type:"checkbox",id:m,name:"choice",value:a,hidden:!0,onChange:i})]},c)}),[n,r]),d=a=>{a.preventDefault(),r===e.translation?e.correctAnswear():r!==""&&e.wrongAnswear()};return l("div",{className:"flex-column--centered multiple-choice-ex",children:[s("img",{className:"flex-element word__img",src:e.imageURL,alt:e.wordName}),s("h4",{className:"u-center-text",children:e.wordName}),s(S,{sentence:e.wordName}),l("form",{className:"flex-column--centered",children:[s("div",{className:"multiple-choices-ctn",children:u}),l("button",{className:"submitBtn u-center-text",onClick:d,children:["Verfică ",s("i",{className:"fas fa-angle-double-right"})]})]})]})}function C(e){const r=(f,x)=>{switch(x.type){case 0:return e.setProgressBar(f.progressBar+x.progressRatio),{progressBar:f.progressBar+x.progressRatio,score:f.score+1,wordIndex:f.wordIndex+1};case 1:return{...f,score:f.score-1};case 2:return e.setProgressBar(f.progressBar+x.progressRatio),{progressBar:f.progressBar+x.progressRatio,score:f.score-1,wordIndex:f.wordIndex+1};default:return f}},[o,n]=t.useReducer(r,{progressBar:50,score:e.score??0,wordIndex:0}),[i,u]=t.useState(!1),d=e.unkwonWords.length,a=sessionStorage.getItem("lessonType"),c=50/e.unkwonWords.length,m={correctAnswear:()=>{n({type:0,progressRatio:c}),u(!1)},wrongAnswear:()=>{n({type:1,progressRatio:c}),u(!0)}},h=()=>{n({type:2,progressRatio:c}),u(!1)};t.useEffect(()=>{e.unkwonWords.sort((f,x)=>.5-Math.random())},[]);const g=t.useMemo(()=>{const f=e.unkwonWords.map(N=>N.wordName),x=e.unkwonWords.map(N=>N.translation);return e.unkwonWords.map((N,k)=>{const w=a==="pronunciation"?k%4:k%3;return w===1?s(Q,{...N,...m,skipExercise:h},k):w===0?s(Y,{...N,...m,wordNames:f},k):w===2?s(Z,{...N,...m,wordsTranslation:x},k):s(H,{...N,...m,skip:h,stopNotification:()=>u(!1)},k)})},[e.unkwonWords]);return t.useEffect(()=>{if(o.wordIndex===e.unkwonWords.length){const f=a==="pronunciation"?2*d:d,x=o.score<=f/3?_.STAR_1:o.score<=f/2?_.STAR_2:_.STAR_3;e.onFinish(x)}},[o.wordIndex]),l("div",{className:"new_words_ex",children:[i&&s(y,{message:"Răspuns greșit !",type:M.ERROR,deleteNotification:()=>u(!1)}),o.wordIndex<e.unkwonWords.length&&g[o.wordIndex]]})}function p(e){const r=L();return t.useEffect(()=>{const o=localStorage.getItem("userAccount"),n=sessionStorage.getItem("lessonId");sessionStorage.removeItem("moduleId"),sessionStorage.removeItem("lessonTitle"),sessionStorage.removeItem("lessonType"),o?P.post("http://localhost:5000/lessons/addProgress",{email:o,lessonId:n,status:e.statusLesson}).then(i=>{sessionStorage.removeItem("lessonId")}):sessionStorage.removeItem("lessonId")},[]),l("div",{className:"flex-column--centered",children:[s("h3",{className:"heading-secondary u-center-text",children:"Lecție terminată"}),l("div",{className:"result-stars",children:[s("i",{className:`fa fa-star ${e.statusLesson!==_.NO_PROGRESS&&"course-status--checked"}`}),s("i",{className:`fa fa-star ${e.statusLesson===_.STAR_3&&"course-status--checked"}`}),s("i",{className:`fa fa-star ${e.statusLesson>_.STAR_1&&"course-status--checked"}`})]}),l("button",{className:"btn-gradient-cyan",onClick:()=>r(-1),children:[" ","Înapoi la lecții"]})]})}const ee=t.lazy(()=>I(()=>import("./StartView-7f4333b3.js"),["assets/StartView-7f4333b3.js","assets/index-927f409d.js","assets/index-f568e4b1.css"])),se=t.lazy(()=>I(()=>import("./GrammerLesson-bb9f69e7.js"),["assets/GrammerLesson-bb9f69e7.js","assets/index-927f409d.js","assets/index-f568e4b1.css"])),te=t.lazy(()=>I(()=>import("./GrammerExercises-09d36904.js"),["assets/GrammerExercises-09d36904.js","assets/index-927f409d.js","assets/index-f568e4b1.css","assets/Notfication-431797d0.js","assets/commonInterfaces-83a6a30d.js"])),ne=t.lazy(()=>I(()=>import("./TestLesson-495c8e0e.js"),["assets/TestLesson-495c8e0e.js","assets/index-927f409d.js","assets/index-f568e4b1.css","assets/Notfication-431797d0.js","assets/GrammerExercises-09d36904.js","assets/commonInterfaces-83a6a30d.js"]));function re(e){const[r,o]=t.useState(0),[n,i]=t.useState([]),[u,d]=t.useState(),[a,c]=t.useState(_.NO_PROGRESS),m=sessionStorage.getItem("lessonType"),[h,g]=t.useTransition(),f=w=>{e.triggerTransition(),setTimeout(()=>o(w),450)},x=w=>{const T=[];return P.post("http://localhost:5000/lessons/getWords",{moduleId:w}).then(R=>(R.data.forEach(E=>{const{id:F,word:O,translation:U,example:V,moduleId:$}=E,j=new Uint8Array(E.image.data),D=new Blob([j],{type:"application/octet-stream"}),J=URL.createObjectURL(D);T.push({id:F,wordName:O.trim(),translation:U.trim(),example:V,moduleId:$,imageURL:J})}),T))};t.useEffect(()=>{(m==="new_words"||m==="pronunciation"||m==="test")&&x(e.moduleId).then(w=>{w.sort((T,R)=>.5-Math.random()),i(w)})},[e.moduleId]);const N=w=>{e.setProgressBar(100),c(w),f(3)},k=w=>{e.triggerTransition(),setTimeout(()=>{d(s(C,{score:w,unkwonWords:n,setProgressBar:e.setProgressBar,onFinish:N}))},450)};return t.useEffect(()=>{if(m==="new_words"){d(s(z,{toExecises:()=>f(2),unkwonWords:n,setProgressBar:e.setProgressBar}));return}if(m==="pronunciation"){d(s(K,{toExecises:k,unkwonWords:n,setProgressBar:e.setProgressBar}));return}if(m==="grammer"){d(s(se,{lessonId:e.lessonId,toExercises:()=>{e.setProgressBar(50),e.triggerTransition(),g(()=>{setTimeout(()=>{d(s(te,{addProgress:e.setProgressBar,lessonId:e.lessonId,toFinish:N}))},470)})}}));return}if(m==="test"){d(s(ne,{unkwonWords:n,setProgressBar:e.setProgressBar,lessonId:e.lessonId,toFinish:N}));return}},[n]),t.useEffect(()=>{r===2&&m!=="pronunciation"&&d(s(C,{unkwonWords:n,setProgressBar:e.setProgressBar,onFinish:N})),r===3&&d(s(p,{statusLesson:a}))},[r,a]),l(v,{children:[r===0&&s(ee,{title:e.lessonTitle,startClickHandler:()=>f(1)}),(r===1||r===2||r===3)&&u]})}function oe(e){const[r,o]=t.useState(!1),n=L(),i=t.useCallback(()=>{sessionStorage.removeItem("lessonType"),sessionStorage.removeItem("lessonId"),sessionStorage.removeItem("moduleId"),sessionStorage.removeItem("lessonTitle"),o(!0),setTimeout(()=>n(-1),410)},[]),u=t.useCallback(()=>{o(!0),setTimeout(()=>e.closeBk(),350)},[]);return s("div",{className:`exit_message__blackdrop ${r&&"exit_message__blackdrop--close"}`,children:l("div",{className:"exit_message__box flex-column--centered",children:[s("div",{className:"btn_exit_ctn",children:l("div",{className:"btn_exit",onClick:u,children:[" ","×"," "]})}),s("h3",{children:" Sigur dorești să închizi lecția ? "}),l("div",{className:"flex-row--centered",children:[l("div",{className:"btn btn--white lesson-btn",onClick:i,children:[" ","Da"," "]}),l("div",{className:"btn btn--blue lesson-btn",onClick:u,children:[" ","Nu"," "]})]})]})})}function ae(){const[e,r]=t.useState(!1);return l(v,{children:[e&&s(oe,{closeBk:()=>r(!1)}),s("div",{className:"lesson__exit",children:s("button",{className:"lesson__exit__btn",onClick:()=>{r(!0)},children:"×"})})]})}function ce(e,r){const o=t.useRef(null);return t.useImperativeHandle(r,()=>({trigger:()=>{o.current.classList.add("lesson-transition--animated")}}),[]),s("div",{className:"lesson-transition",onAnimationEnd:()=>{o.current.classList.remove("lesson-transition--animated")},ref:o})}const ie=t.forwardRef(ce);function le(){const[e,r]=t.useState({lessonId:-1,moduleId:-1,lessonTitle:""}),[o,n]=t.useState(0),i=L(),u=t.useRef({trigger:()=>{}});t.useEffect(()=>{const c=sessionStorage.getItem("lessonId"),m=sessionStorage.getItem("moduleId"),h=sessionStorage.getItem("lessonTitle");c&&m&&h?r({lessonId:+c,moduleId:+m,lessonTitle:h}):i("/Licenta/PageNotFound")},[]);const d=t.useCallback(c=>{c>=0&&c<=100&&n(c)},[]),a=t.useCallback(()=>{u.current.trigger()},[]);return s("div",{className:"lesson-section-ctn",children:l("section",{className:"lesson-section",children:[l("div",{className:"lesson-ctn",children:[e.lessonId>=0&&s(re,{...e,setProgressBar:c=>d(c),triggerTransition:a}),s(ie,{ref:u})]}),s("div",{className:"lesson__progress-bar",children:s(X,{progressStatus:o})}),s(ae,{})]})})}const ge=Object.freeze(Object.defineProperty({__proto__:null,default:le},Symbol.toStringTag,{value:"Module"}));export{Z as C,ge as L,Y as M,Q as W};
