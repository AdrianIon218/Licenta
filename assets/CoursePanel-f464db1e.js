var N=Object.defineProperty;var g=(e,s,t)=>s in e?N(e,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[s]=t;var p=(e,s,t)=>(g(e,typeof s!="symbol"?s+"":s,t),t);import{r as a,u as L,j as S,a as r}from"./index-c2ef99db.js";import{C as R,L as h,a as x}from"./CoursePlan-9b9cec20.js";import{a as C}from"./axios-707ed124.js";var c=(e=>(e[e.NO_PROGRESS=0]="NO_PROGRESS",e[e.STAR_1=1]="STAR_1",e[e.STAR_2=2]="STAR_2",e[e.STAR_3=3]="STAR_3",e))(c||{});function A({children:e,status:s,lessonId:t,moduleId:i}){const{courseLvl:u}=a.useContext(R),_=L(),n=l=>{l.stopPropagation(),sessionStorage.setItem("lessonId",t.toString()),sessionStorage.setItem("moduleId",i.toString()),_("/Licenta/lesson")};return S("div",{className:"course-lesson",children:[r("button",{className:`course-lesson-btn course-lesson-btn--${h[u]}`,onClick:n,children:e}),S("div",{className:`course-status ${u<h.B1?"course-status--A":u>h.B2?"course-status--C":"course-status--B"}`,children:[r("i",{className:`fa fa-star ${s!==c.NO_PROGRESS&&"course-status--checked"}`}),r("i",{className:`fa fa-star ${s===c.STAR_3&&"course-status--checked"}`}),r("i",{className:`fa fa-star ${s>c.STAR_1&&"course-status--checked"}`})]})]})}function E({title:e,activeModule:s,index:t,closeOtherModules:i,lessons:u}){const[_,n]=a.useState(!1),l=h[a.useContext(R).courseLvl],m=()=>{n(o=>(o===!1&&i(),!o))};a.useEffect(()=>{s!==t&&n(!1)},[s]);const f=a.useMemo(()=>u.map((o,d)=>r(A,{status:o.status??c.NO_PROGRESS,lessonId:o.id,moduleId:o.moduleId,children:o.title},d)),[u]);return S("div",{className:"course__module flex-element",tabIndex:t,children:[S("div",{className:"course__module__title u-center-text",onClick:m,children:[e.str,r("span",{className:`course__module__title__arrow course__module__title__arrow--${l}`,children:r("i",{className:` ${_?"fas fa-chevron-up":"fas fa-chevron-down"} `})})]}),r("div",{className:`course__module__ctn ${_&&"course__module__ctn--open"}`,children:r("div",{className:`flex-column--start course__module__ctn__list course__module__ctn__list--${l} ${_&&"course__module__ctn__list--open"}`,children:f})})]})}class T{constructor(s,t){p(this,"_str","Not available");p(this,"setStr",s=>{const t=s.length;t>0&&t<=this.dimension?this._str=s:t===0?this._str="Not available":this._str=s.substring(0,this.dimension)});this.dimension=t,this.setStr(s)}set str(s){this.setStr(s)}get str(){return this._str}}function P({level:e}){const[s,t]=a.useState(-1);a.useContext(R).setCourseLvl(e);const[i,u]=a.useState({modules:[]});a.useEffect(()=>{const n=sessionStorage.getItem("userAccount");C.get("http://localhost:5000/course_modules",{params:{level:h[e],email:n}}).then(l=>{const{lessons:m,modules:f}=l.data;let o=f.map(d=>({title:d.title,lessons:m.filter(v=>v.moduleId===d.id)}));if(n){const{finishedLessons:d}=l.data;u({modules:o,finishedLessons:d})}else u({modules:o})})},[]);const _=a.useMemo(()=>i.modules.map((n,l)=>{const m=i.finishedLessons?n.lessons.map(f=>{const o=i.finishedLessons.find(d=>d.lessonId===f.id);return{...f,status:o?o.progressStatus==="good"?c.STAR_1:o.progressStatus==="very good"?c.STAR_2:c.STAR_3:c.NO_PROGRESS}}):n.lessons;return m.length>0?r(E,{title:new T(n.title,x),index:l,activeModule:s,lessons:m,closeOtherModules:()=>t(l)},l):void 0}),[i,s]);return r("div",{className:`course-plan course-plan--${h[e]}`,children:r("div",{className:"flex-column--centered",children:_})})}export{P as default};
